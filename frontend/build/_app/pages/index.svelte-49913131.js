import{S as e,i as t,s as a,e as o,t as n,c as s,a as c,g as l,d as r,f as i,F as m,h as g,k as u,n as d,b as h,H as f,I as p,G as w,J as y,K as I,A as S,L as v}from"../chunks/vendor-3da8612c.js";function N(e,t,a){const o=e.slice();return o[13]=t[a],o}function T(e){let t,a,u=e[13].name+"";return{c(){t=o("p"),a=n(u)},l(e){t=s(e,"P",{});var o=c(t);a=l(o,u),o.forEach(r)},m(e,o){i(e,t,o),m(t,a)},p(e,t){4&t&&u!==(u=e[13].name+"")&&g(a,u)},d(e){e&&r(t)}}}function b(e){let t,a,g,S,v,b,E,O,P,G,J,U,j,k,$,q,B,C,D,V,A,R,x,M,Q,F=e[2].players||[],H=[];for(let o=0;o<F.length;o+=1)H[o]=T(N(e,F,o));return{c(){t=o("main"),a=o("div"),g=o("input"),S=u(),v=o("button"),b=n("Create game"),E=u(),O=o("br"),P=u(),G=o("div"),J=o("input"),U=u(),j=o("input"),k=u(),$=o("button"),q=n("Join Game"),B=u(),C=o("div"),D=o("button"),V=n("Quit Game"),A=u(),R=o("div"),x=n("Players:\n\t\t");for(let e=0;e<H.length;e+=1)H[e].c();this.h()},l(e){t=s(e,"MAIN",{});var o=c(t);a=s(o,"DIV",{class:!0});var n=c(a);g=s(n,"INPUT",{}),S=d(n),v=s(n,"BUTTON",{});var i=c(v);b=l(i,"Create game"),i.forEach(r),n.forEach(r),E=d(o),O=s(o,"BR",{}),P=d(o),G=s(o,"DIV",{class:!0});var m=c(G);J=s(m,"INPUT",{}),U=d(m),j=s(m,"INPUT",{}),k=d(m),$=s(m,"BUTTON",{});var u=c($);q=l(u,"Join Game"),u.forEach(r),m.forEach(r),B=d(o),C=s(o,"DIV",{class:!0});var h=c(C);D=s(h,"BUTTON",{});var f=c(D);V=l(f,"Quit Game"),f.forEach(r),h.forEach(r),A=d(o),R=s(o,"DIV",{class:!0});var p=c(R);x=l(p,"Players:\n\t\t");for(let t=0;t<H.length;t+=1)H[t].l(p);p.forEach(r),o.forEach(r),this.h()},h(){h(a,"class","svelte-qemy0u"),h(G,"class","svelte-qemy0u"),h(C,"class","svelte-qemy0u"),h(R,"class","svelte-qemy0u")},m(o,n){i(o,t,n),m(t,a),m(a,g),f(g,e[0]),m(a,S),m(a,v),m(v,b),m(t,E),m(t,O),m(t,P),m(t,G),m(G,J),f(J,e[0]),m(G,U),m(G,j),f(j,e[1]),m(G,k),m(G,$),m($,q),m(t,B),m(t,C),m(C,D),m(D,V),m(t,A),m(t,R),m(R,x);for(let e=0;e<H.length;e+=1)H[e].m(R,null);M||(Q=[p(g,"input",e[6]),p(v,"click",e[3]),p(J,"input",e[7]),p(j,"input",e[8]),p($,"click",e[4]),p(D,"click",e[5])],M=!0)},p(e,[t]){if(1&t&&g.value!==e[0]&&f(g,e[0]),1&t&&J.value!==e[0]&&f(J,e[0]),2&t&&j.value!==e[1]&&f(j,e[1]),4&t){let a;for(F=e[2].players||[],a=0;a<F.length;a+=1){const o=N(e,F,a);H[a]?H[a].p(o,t):(H[a]=T(o),H[a].c(),H[a].m(R,null))}for(;a<H.length;a+=1)H[a].d(1);H.length=F.length}},i:w,o:w,d(e){e&&r(t),y(H,e),M=!1,I(Q)}}}function E(e,t,a){let o,n,s,c,l;console.log("Refreshing...");S((async()=>{l=await(async()=>{console.log("Connecting...");const e=await(new v).withUrl("/api").withAutomaticReconnect().build();return await e.start(),e})(),console.log(l),l.on("newMessage",(e=>{a(2,s=e)})),window.localStorage.getItem("playerSecret")&&window.localStorage.getItem("gameId")&&(c=window.localStorage.getItem("playerSecret"),a(1,n=window.localStorage.getItem("gameId")),r())}));const r=async()=>{const{connectionId:e}=l,t=await fetch(`/api/joinGameStream/${n}`,{method:"POST",body:JSON.stringify({connectionId:e,playerSecret:c})});console.log(`Join game stream response: ${t.status}`)};return[o,n,s,async()=>{const{connectionId:e}=l,t=await fetch("/api/createGame",{method:"POST",body:JSON.stringify({connectionId:e,playerName:o})});console.log(`Create game response: ${t.status}`);const s=await t.json();c=s.playerSecret,a(1,n=s.game),201===t.status&&r(),window.localStorage.setItem("playerSecret",c),window.localStorage.setItem("gameId",n)},async()=>{const{connectionId:e}=l,t=await fetch(`/api/joinGame/${n}`,{method:"POST",body:JSON.stringify({connectionId:e,playerName:o})});console.log(`Join game response: ${t.status}`);const a=await t.json();c=a.playerSecret,200===t.status&&r(),window.localStorage.setItem("playerSecret",c),window.localStorage.setItem("gameId",n)},async()=>{window.localStorage.setItem("gameId",""),window.localStorage.setItem("playerSecret",""),a(1,n=""),c=""},function(){o=this.value,a(0,o)},function(){o=this.value,a(0,o)},function(){n=this.value,a(1,n)}]}export default class extends e{constructor(e){super(),t(this,e,E,b,a,{})}}
