import{S as e,i as a,s as t,e as o,k as s,t as n,c,a as i,n as r,g as l,d as m,b as g,f as u,F as d,H as w,I,h as S,G as h,J as y,A as p,K as f}from"../chunks/vendor-6f03b65a.js";function v(e){let a,t,p,f,v,N,T,b,O,J,E,G,U,P,j,k,B,$,q,C,D,R,V,A,x,M,Q,F,H,K=JSON.stringify(e[2])+"";return{c(){a=o("main"),t=o("div"),p=o("input"),f=s(),v=o("button"),N=n("Create game"),T=s(),b=o("br"),O=s(),J=o("div"),E=o("input"),G=s(),U=o("input"),P=s(),j=o("button"),k=n("Join Game"),B=s(),$=o("div"),q=o("button"),C=n("Quit Game"),D=s(),R=o("div"),V=n(K),A=s(),x=o("br"),M=n("\n\t\tSecret: "),Q=n(e[3]),this.h()},l(o){a=c(o,"MAIN",{});var s=i(a);t=c(s,"DIV",{class:!0});var n=i(t);p=c(n,"INPUT",{}),f=r(n),v=c(n,"BUTTON",{});var g=i(v);N=l(g,"Create game"),g.forEach(m),n.forEach(m),T=r(s),b=c(s,"BR",{}),O=r(s),J=c(s,"DIV",{class:!0});var u=i(J);E=c(u,"INPUT",{}),G=r(u),U=c(u,"INPUT",{}),P=r(u),j=c(u,"BUTTON",{});var d=i(j);k=l(d,"Join Game"),d.forEach(m),u.forEach(m),B=r(s),$=c(s,"DIV",{class:!0});var w=i($);q=c(w,"BUTTON",{});var I=i(q);C=l(I,"Quit Game"),I.forEach(m),w.forEach(m),D=r(s),R=c(s,"DIV",{class:!0});var S=i(R);V=l(S,K),A=r(S),x=c(S,"BR",{}),M=l(S,"\n\t\tSecret: "),Q=l(S,e[3]),S.forEach(m),s.forEach(m),this.h()},h(){g(t,"class","svelte-qemy0u"),g(J,"class","svelte-qemy0u"),g($,"class","svelte-qemy0u"),g(R,"class","svelte-qemy0u")},m(o,s){u(o,a,s),d(a,t),d(t,p),w(p,e[0]),d(t,f),d(t,v),d(v,N),d(a,T),d(a,b),d(a,O),d(a,J),d(J,E),w(E,e[0]),d(J,G),d(J,U),w(U,e[1]),d(J,P),d(J,j),d(j,k),d(a,B),d(a,$),d($,q),d(q,C),d(a,D),d(a,R),d(R,V),d(R,A),d(R,x),d(R,M),d(R,Q),F||(H=[I(p,"input",e[7]),I(v,"click",e[4]),I(E,"input",e[8]),I(U,"input",e[9]),I(j,"click",e[5]),I(q,"click",e[6])],F=!0)},p(e,[a]){1&a&&p.value!==e[0]&&w(p,e[0]),1&a&&E.value!==e[0]&&w(E,e[0]),2&a&&U.value!==e[1]&&w(U,e[1]),4&a&&K!==(K=JSON.stringify(e[2])+"")&&S(V,K),8&a&&S(Q,e[3])},i:h,o:h,d(e){e&&m(a),F=!1,y(H)}}}function N(e,a,t){let o,s,n,c,i;console.log("Refreshing...");p((async()=>{i=await(async()=>{console.log("Connecting...");const e=await(new f).withUrl("/api").withAutomaticReconnect().build();return await e.start(),e})(),console.log(i),i.on("newMessage",(e=>{t(2,n=e)})),window.localStorage.getItem("playerSecret")&&window.localStorage.getItem("gameId")&&(t(3,c=window.localStorage.getItem("playerSecret")),t(1,s=window.localStorage.getItem("gameId")),r())}));const r=async()=>{const{connectionId:e}=i,a=await fetch(`/api/joinGameStream/${s}`,{method:"POST",body:JSON.stringify({connectionId:e,playerSecret:c})});console.log(`Join game stream response: ${a.status}`)};return[o,s,n,c,async()=>{const{connectionId:e}=i,a=await fetch("/api/createGame",{method:"POST",body:JSON.stringify({connectionId:e,playerName:o})});console.log(`Create game response: ${a.status}`);const n=await a.json();t(3,c=n.playerSecret),t(1,s=n.game),201===a.status&&r(),window.localStorage.setItem("playerSecret",c),window.localStorage.setItem("gameId",s)},async()=>{const{connectionId:e}=i,a=await fetch(`/api/joinGame/${s}`,{method:"POST",body:JSON.stringify({connectionId:e,playerName:o})});console.log(`Join game response: ${a.status}`);const n=await a.json();t(3,c=n.playerSecret),200===a.status&&r(),window.localStorage.setItem("playerSecret",c),window.localStorage.setItem("gameId",s)},async()=>{window.localStorage.setItem("gameId",""),window.localStorage.setItem("playerSecret",""),t(1,s=""),t(3,c="")},function(){o=this.value,t(0,o)},function(){o=this.value,t(0,o)},function(){s=this.value,t(1,s)}]}export default class extends e{constructor(e){super(),a(this,e,N,v,t,{})}}
