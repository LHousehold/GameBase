import{S as e,i as a,s as t,e as o,k as s,t as n,c,a as i,n as r,g as l,d as m,b as g,f as u,F as d,H as w,I as S,h,G as p,J as I,A as y,K as f}from"../chunks/vendor-6f03b65a.js";function v(e){let a,t,y,f,v,N,b,J,O,T,E,G,P,U,j,$,k,B,C,R,q,A,D,V,x,M=JSON.stringify(e[2])+"";return{c(){a=o("main"),t=o("div"),y=o("input"),f=s(),v=o("button"),N=n("Create game"),b=s(),J=o("br"),O=s(),T=o("div"),E=o("input"),G=s(),P=o("input"),U=s(),j=o("button"),$=n("Join Game"),k=s(),B=o("div"),C=n(M),R=s(),q=o("br"),A=n("\n\t\tSecret: "),D=n(e[3]),this.h()},l(o){a=c(o,"MAIN",{});var s=i(a);t=c(s,"DIV",{class:!0});var n=i(t);y=c(n,"INPUT",{}),f=r(n),v=c(n,"BUTTON",{});var g=i(v);N=l(g,"Create game"),g.forEach(m),n.forEach(m),b=r(s),J=c(s,"BR",{}),O=r(s),T=c(s,"DIV",{class:!0});var u=i(T);E=c(u,"INPUT",{}),G=r(u),P=c(u,"INPUT",{}),U=r(u),j=c(u,"BUTTON",{});var d=i(j);$=l(d,"Join Game"),d.forEach(m),u.forEach(m),k=r(s),B=c(s,"DIV",{class:!0});var w=i(B);C=l(w,M),R=r(w),q=c(w,"BR",{}),A=l(w,"\n\t\tSecret: "),D=l(w,e[3]),w.forEach(m),s.forEach(m),this.h()},h(){g(t,"class","svelte-qemy0u"),g(T,"class","svelte-qemy0u"),g(B,"class","svelte-qemy0u")},m(o,s){u(o,a,s),d(a,t),d(t,y),w(y,e[0]),d(t,f),d(t,v),d(v,N),d(a,b),d(a,J),d(a,O),d(a,T),d(T,E),w(E,e[0]),d(T,G),d(T,P),w(P,e[1]),d(T,U),d(T,j),d(j,$),d(a,k),d(a,B),d(B,C),d(B,R),d(B,q),d(B,A),d(B,D),V||(x=[S(y,"input",e[6]),S(v,"click",e[4]),S(E,"input",e[7]),S(P,"input",e[8]),S(j,"click",e[5])],V=!0)},p(e,[a]){1&a&&y.value!==e[0]&&w(y,e[0]),1&a&&E.value!==e[0]&&w(E,e[0]),2&a&&P.value!==e[1]&&w(P,e[1]),4&a&&M!==(M=JSON.stringify(e[2])+"")&&h(C,M),8&a&&h(D,e[3])},i:p,o:p,d(e){e&&m(a),V=!1,I(x)}}}function N(e,a,t){let o,s,n,c,i;console.log("Refreshing...");y((async()=>{i=await(async()=>{console.log("Connecting...");const e=await(new f).withUrl("/api").withAutomaticReconnect().build();return await e.start(),e})(),console.log(i),i.on("newMessage",(e=>{t(2,n=e)})),window.localStorage.getItem("playerSecret")&&window.localStorage.getItem("gameId")&&(t(3,c=window.localStorage.getItem("playerSecret")),t(1,s=window.localStorage.getItem("gameId")),r())}));const r=async()=>{const{connectionId:e}=i,a=await fetch(`/api/joinGameStream/${s}`,{method:"POST",body:JSON.stringify({connectionId:e,playerSecret:c})});console.log(`Join game stream response: ${a.status}`)};return[o,s,n,c,async()=>{const{connectionId:e}=i,a=await fetch("/api/createGame",{method:"POST",body:JSON.stringify({connectionId:e,playerName:o})});console.log(`Create game response: ${a.status}`);const n=await a.json();t(3,c=n.playerSecret),t(1,s=n.game),201===a.status&&r(),window.localStorage.setItem("playerSecret",c),window.localStorage.setItem("gameId",s)},async()=>{const{connectionId:e}=i,a=await fetch(`/api/joinGame/${s}`,{method:"POST",body:JSON.stringify({connectionId:e,playerName:o})});console.log(`Join game response: ${a.status}`);const n=await a.json();t(3,c=n.playerSecret),200===a.status&&r(),window.localStorage.setItem("playerSecret",c),window.localStorage.setItem("gameId",s)},function(){o=this.value,t(0,o)},function(){o=this.value,t(0,o)},function(){s=this.value,t(1,s)}]}export default class extends e{constructor(e){super(),a(this,e,N,v,t,{})}}
